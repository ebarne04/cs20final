<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Quiz for Directory Entry</title>
        <link rel= "stylesheet" href="style.css">
        <style type="text/css">
                h1{
                        text-align: center;
                }
                .form-container {
                    max-width: 800px;
                    margin: 0 auto;
                    padding: 50px; 
                    padding-left: 200px;
                    padding-right: 200px;
                    background-color: #f8f8f8;
                    border-radius: 10px;
                    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
                }

                .form-section-label {
                    font-size: 24px;
                    font-weight: bold;
                    text-align: center;
                    margin-top: 10px;
                    margin-bottom: 40px; 
                    color: #333;
                }

                .form-section-label::after {
                    content: "";
                    display: block;
                    width: 350px; /* Adjust width as desired */
                    height: 2px; /* Adjust thickness */
                    background-color: #F08080; /* Coral color for the line */
                    margin-top: 12px;
                    margin: 0 auto;
                }

                .form-row {
                    display: flex;
                    flex-direction: column;
                    padding: 0;
                    width: 100%;
                }

                .form-group {
                    display: flex;
                    flex-direction: column;
                    text-align: center;
                    margin-bottom: 40px;
                    width: 100%;
                }

                label {
                    font-size: 16px;
                    margin-bottom: 8px; 
                    color: #666;
                }

                input[type="text"],
                input[type="number"],
                input[type="time"],
                select {
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 8px;
                    font-size: 16px;
                    background-color: #fff;
                    outline: none;
                    box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.1);
                    transition: box-shadow 0.2s;
                    margin: 0;
                }

                .cta-button {
                    width: 100%;
                    padding: 12px;
                    font-size: 18px;
                    color: #fff;
                    background-color: #3172AE;
                    border: none;
                    border-radius: 8px;
                    cursor: pointer;
                    transition: background-color 0.2s;
                    margin-top: 20px;
                }

                /* Error Styling */
                .error {
                    color: #d9534f;
                    font-size: 14px;
                    margin-top: 5px;
                    text-align: left;
                    display: none;
                }
                footer{
                        margin-top: auto;
                }
                @media (max-width: 768px) {
                    .form-container {
                        max-width: 90%; 
                        padding: 20px; 
                    }

                    .form-row {
                        flex-direction: column; 
                    }

                    .form-group {
                        text-align: left;
                        margin-bottom: 20px; 
                    }

                    .cta-button {
                        font-size: 16px; 
                    }
                }
        </style>
    </head>
    <body>
        <!-- Navbar -->
    <nav>
        <div class="logo">
            <a href="index.html"><img src="NewLogo.png" alt="Logo"></a>
        </div>
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li>
                <a href="#" class="dropdown">About</a>
                <ul class="dropdown-menu">
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="testimony.html">Testimonials</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="dropdown">Directory</a>
                <ul class="dropdown-menu">
                    <li><a href="directory1.php">On-Campus</a></li>
                    <li><a href="directory2.php">Off-Campus</a></li>
                </ul>
            </li>
            <li><a href="quiz.php">Survey</a></li>
        </ul>
    </nav>
    
        <div class="main-content">
                <h1 style="padding-top: 20px; padding-bottom: 20px;">Take Our Housing Survey!</h1>
                <div class="form-container">
                        <div class="form-section-label">General Information</div>
                        <form id="survey-form" method="POST" action="results.php">
                                <div class="form-row">
                                <div class="form-group">
                                        <label for="name">Name:</label>
                                        <input type="text" id="name" name="name" required>
                                        <div id="name-error" class="error"></div>
                                </div>
                                <div class="form-group">
                                        <label for="hometown">Hometown:</label>
                                        <input type="text" id="hometown" name="hometown" required>
                                </div>
                                <div class="form-group">
                                        <label for="phone">Phone Number:</label>
                                        <input type="text" id="phone" name="phone" placeholder="ex: 9175558965" required>
                                        <div id="phone-error" class="error"></div>
                                </div>
                                </div>
                        
                                <div class="form-row">
                                <div class="form-group">
                                        <label for="major">Major:</label>
                                        <input type="text" id="major" name="major" required>
                                </div>
                                <div class="form-group">
                                        <label for="gender">Gender:</label>
                                        <select id="gender" name="gender">
                                            <option value="" disabled selected>Select your gender</option>
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                            <option value="Other">Other</option>
                                        </select>
                                </div>
                                </div>
                        
                                <div class="form-group">
                                <label for="onCampus">Living Location:</label>
                                <select id="onCampus" name="onCampus" required>
                                        <option value="" disabled selected>Select your location</option>
                                        <option value="true">On Campus</option>
                                        <option value="false">Off Campus</option>
                                </select>
                                <div id="onCampus-error" class="error"></div>
                                </div>
                        
                                <div class="form-section-label">Personal Preferences</div>
                        
                                <div class="form-row">
                                <div class="form-group">
                                        <label for="cleanliness">Cleanliness (1-10):</label>
                                        <input type="number" id="cleanliness" name="cleanliness" min="1" max="10" required>
                                        <div id="cleanliness-error" class="error"></div>
                                </div>
                                </div>
                        
                                <div class="form-row">
                                <div class="form-group">
                                        <label for="wakeup">Wakeup Time:</label>
                                        <input type="time" id="wakeup" name="wakeup" required>
                                </div>
                                <div class="form-group">
                                        <label for="bedtime">Bedtime:</label>
                                        <input type="time" id="bedtime" name="bedtime" required>
                                </div>
                                </div>
                        
                                <div class="form-row">
                                <div class="form-group">
                                        <label for="smoker">Smoker:</label>
                                        <select id="smoker" name="smoker">
                                            <option value="true">Yes</option>
                                            <option value="false">No</option>
                                        </select>
                                </div>
                                </div>
                        
                                <button class="cta-button" id="submit_btn" type="submit">Submit</button>
                        </form>
                
                </div>
        </div>

        <script>
                document.addEventListener("DOMContentLoaded", () => {
                        document.getElementById("submit_btn").addEventListener("click", validateAndGenerateResult);
                });
                async function validate_phone(num) {
                    const apiKey = '174c1de16569eb1b62ccdd7be239c78c';
                    const apiUrl = `https://apilayer.net/api/validate?access_key=${apiKey}&number=${num}&format=1`;

                    try {
                        const response = await fetch(apiUrl);
                        const data = await response.json();
                        console.log(data);
                        return data.valid;
                    } catch (error) {
                        console.error('Error:', error);
                    }
                }
            
                async function validateAndGenerateResult() {
                        event.preventDefault(); 
                        let valid = true;
                        document.getElementById("name-error").innerText = "";
                        document.getElementById("cleanliness-error").innerText = "";
                        document.getElementById("onCampus-error").innerText = "";
                        document.getElementById("name-error").style.display = "none";
                        document.getElementById("cleanliness-error").style.display = "none";
                        document.getElementById("onCampus-error").style.display = "none";

                        const name = document.getElementById("name").value.trim();
                        if (name === "") {
                                document.getElementById("name-error").style.display = "block";
                                document.getElementById("name-error").innerText = "Name is required.";
                                valid = false;
                        }

                        const cleanlinessScore = parseInt(document.getElementById("cleanliness").value, 10);
                        if (isNaN(cleanlinessScore) || cleanlinessScore < 1 || cleanlinessScore > 10) {
                                document.getElementById("cleanliness-error").style.display = "block";
                                document.getElementById("cleanliness-error").innerText = "Cleanliness must be between 1 and 10.";
                                valid = false;
                        }

                        const onCampusSelection = document.getElementById("onCampus").value;
                        if (!onCampusSelection) {
                            document.getElementById("onCampus-error").style.display = "block";    
                            document.getElementById("onCampus-error").innerText = "Please select where you want to live.";
                                valid = false;
                        }
                        
                            const phone = document.getElementById("phone").value.trim();
                            if (phone === "" || !/^\d{10}$/.test(phone)) {
                                document.getElementById("phone-error").style.display = "block";
                                document.getElementById("phone-error").innerText = "Please enter a valid 10-digit phone number.";
                                valid = false;
                            } else {
                                const formatted_num = "1" + phone; // Assuming the country code is 1 (USA)
                                const phone_valid = await validate_phone(formatted_num);
                                if (!phone_valid) {
                                    document.getElementById("phone-error").style.display = "block";
                                    document.getElementById("phone-error").innerText = "Please enter a valid 10-digit phone number.";
                                    valid = false;
                                }
                            }

                            // If everything is valid, allow the form to be submitted
                            if (valid) {
                                document.getElementById("survey-form").submit();
                            }
                }
        </script>
        <footer>
                <div class="left-footer">
                    <img src="NewLogo.png" alt="Logo">
                    <p style="padding-top: 35px;">&copy; 2024 JumboMate. All Rights Reserved.</p>
                </div>
                <div class="right-footer">
                    <a href= "index.html">Home</a>
                    <a href= "about.html">About Us</a>
                    <a href= "contact.html">Contact</a>
                    <a href= "quiz.html">Quiz</a>
                </div>
            </footer>


            <script>
                document.addEventListener("DOMContentLoaded", () => {
                    const hamburger = document.querySelector(".hamburger");
                    const navLinks = document.querySelector(".nav-links");
        
                    hamburger.addEventListener("click", () => {
                        navLinks.classList.toggle("active");
                    });
                });
            </script>
    </body>
</html>